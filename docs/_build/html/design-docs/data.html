
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Data Storage &#8212; mewbot 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Kitteh’s Bot Framework/Infrastructure" href="README.html" />
    <link rel="prev" title="Data Flow" href="data-flow.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <!--
SPDX-FileCopyrightText: 2021 - 2023 Mewbot Developers <mewbot@quicksilver.london>

SPDX-License-Identifier: CC-BY-4.0
--><section id="data-storage">
<h1>Data Storage<a class="headerlink" href="#data-storage" title="Permalink to this heading">¶</a></h1>
<p>A lot of bot functionality relies on persistent or external data;
even the most basic call-and-response command may want to have a
way to easily edit the response.
The objects of the type <code class="docutils literal notranslate"><span class="pre">DataSource</span></code> and <code class="docutils literal notranslate"><span class="pre">DataStore</span></code> offer persistent
storage outside a bot’s primary configuration.</p>
<section id="datasource">
<h2>DataSource<a class="headerlink" href="#datasource" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">DataSource</span></code>s are read-only sources of data that can be used by <code class="docutils literal notranslate"><span class="pre">Triggers</span></code>,
<code class="docutils literal notranslate"><span class="pre">Conditions</span></code>, and <code class="docutils literal notranslate"><span class="pre">Actions</span></code> to provide configuration values that are not
stored as part of the configuration.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DataSource</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;A source of data for use in behaviours.</span>
<span class="sd">  A data source can contain any number of items with a common primitive type.</span>

<span class="sd">  The source can be accessed as if it is an array, dictionary, or single value;</span>
<span class="sd">  each subclass must support one of these, but may support any combination</span>
<span class="sd">  thereof.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns an item in this Source. The source can choose if this is the</span>
<span class="sd">    first item, a random item, or the next in the iteration of this source (or</span>
<span class="sd">    any other semantics that make sense for the source). This function may</span>
<span class="sd">    raise an IOException if there is a problem communicating with the backing</span>
<span class="sd">    store for this source, or a DataSourceEmpty exception if there is no data</span>
<span class="sd">    to return.&quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the number of items in this DataStore.</span>

<span class="sd">    This may return -1 to indicte that the length is unknown, otherwise it</span>
<span class="sd">    should return a usable value that matches the length of .keys()</span>
<span class="sd">    (for sources that work like dictionary) or the maximum slice value</span>
<span class="sd">    (for sources that work like a sequence).&quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Allows access to a value in this DataStore via a key.</span>
<span class="sd">    If key is of an inappropriate type, TypeError may be raised;</span>
<span class="sd">    this includes if this source is a single value.</span>
<span class="sd">    If the value is outside the index range, IndexError should be raised.</span>
<span class="sd">    For mapping types, if key is missing (not in the container),</span>
<span class="sd">    KeyError should be raised.&quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;All the keys for a dictionary accessed source.&quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">random</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets a random item from this source.&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="datastore">
<h2>DataStore<a class="headerlink" href="#datastore" title="Permalink to this heading">¶</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">DataStore</span></code> extends a <code class="docutils literal notranslate"><span class="pre">DataSource</span></code> by allowing the bot to add, update,
replace, or delete data at runtime. This allows the bot to have ‘memory’.</p>
<p>All records in a <code class="docutils literal notranslate"><span class="pre">DataStore</span></code> have associated metadata, including a
moderation status, an updated timestamp, and information on where the
value was created from.</p>
<p>Functions which are inherited from <code class="docutils literal notranslate"><span class="pre">DataSource</span></code> will not return the metadata
in order to maintain compatibility. They must not return records in the
REJECTED moderation state, and the store may choose to also exclude pending
items from these functions.</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>python
enum DataModerationState:</p>
<blockquote>
<div><p>APPROVED =  1
PENDING  =  0
REJECTED = -1</p>
</div></blockquote>
<dl class="simple">
<dt>class DataRecord(Generic[T]):</dt><dd><p>value: T
created: datetime.datetime
status: DataModerationState
source: str</p>
</dd>
</dl>
<p>class DataStore(Generic[T], DataSource[T]):</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">mewbot</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../top_level_md_files/main_code_of_conduct.html">Contributor Covenant Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../top_level_md_files/main_contributing.html">CONTRIBUTING.md</a></li>
<li class="toctree-l1"><a class="reference internal" href="../top_level_md_files/main_contributing.html#contributing">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../top_level_md_files/main_contributors.html">CONTRIBUTORS.md</a></li>
<li class="toctree-l1"><a class="reference internal" href="../top_level_md_files/main_contributors.html#contributors">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../top_level_md_files/main_license.html">LICENSE.md</a></li>
<li class="toctree-l1"><a class="reference internal" href="../top_level_md_files/main_readme.html">README.md</a></li>
<li class="toctree-l1"><a class="reference internal" href="../top_level_md_files/main_readme.html#mewbot">MewBot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README_DOCS.html">Welcome to the mewbot docs!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README_DOCS.html#what-should-go-in-here">What should go in here?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README_DOCS.html#why-are-there-a-mix-of-md-files-and-rst-files-in-here">Why are there a mix of md files and rst files in here?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README_DOCS.html#how-do-i-build-this-documentation">How do I build this documentation?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README_DOCS.html#how-to-i-contribute-to-these-docs">How to I contribute to these docs?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README_DOCS.html#doc-strings">Doc strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README_DOCS.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README_DOCS.html#things-to-look-into-later">Things to look into later</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-docs/io-dev-notes/discord-dev-notes.html">Why am I getting blank events when messages are sent in channels the bot is monitoring?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-docs/io-dev-notes/discord-dev-notes.html#pycord-is-not-seeing-events-i-expect-it-to">Pycord is not seeing events I expect it to</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-flow.html">Data Flow</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data Storage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#datasource">DataSource</a></li>
<li class="toctree-l2"><a class="reference internal" href="#datastore">DataStore</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="README.html">Kitteh’s Bot Framework/Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="vision.html">Vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_mewbot/mewbot.api.html">mewbot.api package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_mewbot/mewbot.core.html">mewbot.core package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_mewbot/mewbot.io.html">mewbot.io package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_mewbot/mewbot.html">mewbot package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_mewbot/mewbot.test.html">mewbot.test package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_mewbot/mewbot.tools.html">mewbot.tools package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_mewbot/modules.html">mewbot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_examples/examples.discord_bots.html">examples.discord_bots package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_examples/examples.html">examples package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_examples/modules.html">examples</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../design-docs-index.html">&lt;no title&gt;</a><ul>
      <li>Previous: <a href="data-flow.html" title="previous chapter">Data Flow</a></li>
      <li>Next: <a href="README.html" title="next chapter">Kitteh’s Bot Framework/Infrastructure</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Mewler Org.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/design-docs/data.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>